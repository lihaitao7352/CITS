テプシスのプロジェクト予想・プロジェクト情報のプ想プロ情報＿業務種別＿コード(PPJD_GMS_COD)
が正しいかチェックしたいのですが。
チェックのSQLの作成をお願いします。

条件1.

【プロジェクト予想・プロジェクト情報】の「プ想プロ情報＿件名＿コード」(複数あり)一件に絞り
【件名予想・件名情報】の最新バージョン(指定)の「プ予想件名情報＿件名＿コード」とマッチングして
「プ想プロ情報＿業務種別＿コード」と「予想件名情報＿業務種別＿コード」に差異があるプロジェクトを抽出する。

取得項目
①会社コード
②所属コード
③プロジェクトコード
④件名コード
⑤業務種別コード
⑥着手日
⑦完了日

ソート
①②③④

条件2.

【プロジェクト予想・プロジェクト情報】のプ想プロ情報＿所属＿コードと
【組織属性定数(BVTB3_SSZD)】の最新の組織属性＿組織＿コードをマッチングし組織属性＿組織＿分類＿コードを取得する。
取得した「組織属性＿組織＿分類＿コード」と【契約区分定数(BVTG1_KKBD)】の「契約区分情報＿契約＿区分＿コード(9%)」の
「契約区分情報＿組織＿分類＿コード」とマッチングする。マッチングしなければエラーとする。
取得した「契約区分情報＿組織＿分類＿コード」と【業務種別定数(BVTG1_GMSD)】の「業務種別情報＿契約＿区分＿コード(GMSD_KEK_KBN_COD)」
とマッチングして「業務種別情報＿業務種別＿コード」を取得する。
取得した「業務種別情報＿業務種別＿コード」とプ【プロジェクト予想・プロジェクト情報】の「プ想プロ情報＿業務種別＿コード」を比較して
アンマッチのプロジェクトを抽出する。

取得項目
①会社コード
②所属コード
③プロジェクトコード
④プロジェクト予想・プロジェクト情報/業務種別コード　
⑤業務種別定数/業務種別コード
⑥着手日
⑦完了日

ソート
①②③

条件3.
【プロジェクト予想・プロジェクト情報】の「プ想プロ情報＿プロジェクト＿コード」と
【プロジェクト情報（カレント）】の「プロカレント＿プロジェクト＿コード」をマッチングし
「プ想プロ情報＿業務種別＿コード」と「プロカレント＿業務種別＿コード」に差異があるプロジェクトを抽出する。

取得項目
①会社コード
②所属コード
③プロジェクトコード
④プロジェクト予想・プロジェクト情報/業務種別コード　
⑤プロジェクト情報（カレント）/業務種別コード
⑥着手日
⑦完了日

ソート

①②③
どちらかの一方にある場合は差異とする。
