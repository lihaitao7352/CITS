テプシスのプロジェクト予想・プロジェクト情報のプ想プロ情報＿業務種別＿コード(PPJD_GMS_COD)
が正しいかチェックしたいのですが。
チェックのSQLの作成をお願いします。

条件1.

【プロジェクト予想・プロジェクト情報】の「プ想プロ情報＿件名＿コード」(複数あり)一件に絞り
【件名予想・件名情報】の最新バージョン(指定)の「プ予想件名情報＿件名＿コード」とマッチングして
「プ想プロ情報＿業務種別＿コード」と「予想件名情報＿業務種別＿コード」に差異があるプロジェクトを抽出する。

取得項目
①会社コード
②所属コード
③プロジェクトコード
④件名コード
⑤業務種別コード
⑥着手日
⑦完了日

ソート
①②③④

条件2.

【プロジェクト予想・プロジェクト情報】のプ想プロ情報＿所属＿コードと
【組織属性定数(BVTB3_SSZD)】の最新の組織属性＿組織＿コードをマッチングし組織属性＿組織＿分類＿コードを取得する。
取得した「組織属性＿組織＿分類＿コード」と【契約区分定数(BVTG1_KKBD)】の「契約区分情報＿契約＿区分＿コード(9%)」の
「契約区分情報＿組織＿分類＿コード」とマッチングする。マッチングしなければエラーとする。
取得した「契約区分情報＿組織＿分類＿コード」と【業務種別定数(BVTG1_GMSD)】の「業務種別情報＿契約＿区分＿コード(GMSD_KEK_KBN_COD)」
とマッチングして「業務種別情報＿業務種別＿コード」を取得する。
取得した「業務種別情報＿業務種別＿コード」とプ【プロジェクト予想・プロジェクト情報】の「プ想プロ情報＿業務種別＿コード」を比較して
アンマッチのプロジェクトを抽出する。

取得項目
①会社コード
②所属コード
③プロジェクトコード
④プロジェクト予想・プロジェクト情報/業務種別コード　
⑤業務種別定数/業務種別コード
⑥着手日
⑦完了日

ソート
①②③

条件3.
【プロジェクト予想・プロジェクト情報】の「プ想プロ情報＿プロジェクト＿コード」と
【プロジェクト情報（カレント）】の「プロカレント＿プロジェクト＿コード」をマッチングし
「プ想プロ情報＿業務種別＿コード」と「プロカレント＿業務種別＿コード」に差異があるプロジェクトを抽出する。

取得項目
①会社コード
②所属コード
③プロジェクトコード
④プロジェクト予想・プロジェクト情報/業務種別コード　
⑤プロジェクト情報（カレント）/業務種別コード
⑥着手日
⑦完了日

ソート

①②③
どちらかの一方にある場合は差異とする。
---条件1: プロジェクトコードの差異を確認
SELECT
    a.会社コード,
    a.所属コード,
    a.プロジェクトコード,
    a.件名コード,
    a.業務種別コード,
    a.着手日,
    a.完了日
FROM
    プロジェクト予想・プロジェクト情報 a
JOIN
    件名予想・件名情報 b ON a.プ想プロ情報_件名_コード = b.プ予想件名情報_件名_コード
WHERE
    a.プ想プロ情報_業務種別_コード != b.予想件名情報_業務種別_コード
ORDER BY
    a.会社コード, a.所属コード, a.プロジェクトコード, a.件名コード;
--条件2: 組織属性と業務種別の確認
WITH 最新組織属性 AS (
    SELECT DISTINCT
        組織属性_組織_コード,
        組織属性_組織_分類_コード
    FROM
        組織属性定数
    WHERE
        /* 組織属性定数テーブルの最新の日付を指定 */
),
契約区分組織 AS (
    SELECT
        契約区分情報_組織_分類_コード
    FROM
        契約区分定数
    WHERE
        契約区分情報_契約_区分_コード LIKE '9%'
)
SELECT
    a.会社コード,
    a.所属コード,
    a.プロジェクトコード,
    a.プ想プロ情報_業務種別_コード AS プロジェクト情報業務種別コード,
    c.業務種別情報_業務種別_コード AS 業務種別定数業務種別コード,
    a.着手日,
    a.完了日
FROM
    プロジェクト予想・プロジェクト情報 a
JOIN
    最新組織属性 b ON a.プ想プロ情報_所属_コード = b.組織属性_組織_コード
JOIN
    契約区分組織 d ON b.組織属性_組織_分類_コード = d.契約区分情報_組織_分類_コード
JOIN
    業務種別定数 c ON c.業務種別情報_契約_区分_コード = d.契約区分情報_組織_分類_コード
WHERE
    a.プ想プロ情報_業務種別_コード != c.業務種別情報_業務種別_コード
ORDER BY
    a.会社コード, a.所属コード, a.プロジェクトコード;
--条件3: プロジェクトコードの現在と予想の差異を確認
SELECT
    a.会社コード,
    a.所属コード,
    a.プロジェクトコード,
    a.プ想プロ情報_業務種別_コード AS 予想業務種別コード,
    b.プロカレント_業務種別_コード AS 現在業務種別コード,
    a.着手日,
    a.完了日
FROM
    プロジェクト予想・プロジェクト情報 a
JOIN
    プロジェクト情報（カレント） b ON a.プ想プロ情報_プロジェクト_コード = b.プロカレント_プロジェクト_コード
WHERE
    a.プ想プロ情報_業務種別_コード != b.プロカレント_業務種別_コード
ORDER BY
    a.会社コード, a.所属コード, a.プロジェクトコード;
